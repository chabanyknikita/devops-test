# üß© DevOps Testing Task
## üìò –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É

–¶–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –º—ñ—Å—Ç–∏—Ç—å NestJS –¥–æ–¥–∞—Ç–æ–∫, –∞ —Ç–∞–∫–æ–∂ –ø–æ–≤–Ω—É DevOps-—ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –π–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—ó, –¥–µ–ø–ª–æ—é —Ç–∞ –±–µ–∑–ø–µ–∫–∏ –≤ Kubernetes.
–ú–µ—Ç–∞ ‚Äî –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä—É–≤–∞—Ç–∏ –ø–æ–≤–Ω–∏–π CI/CD —Ü–∏–∫–ª, —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ Vault, Kyverno, Redis, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è, –ø–æ–ª—ñ—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏, –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –ø—ñ–¥–ø–∏—Å—É–≤–∞–Ω–Ω—è —ñ–º–µ–¥–∂—ñ–≤.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
```
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docs
‚îÇ   ‚îú‚îÄ‚îÄ ci-cd.md
‚îÇ   ‚îú‚îÄ‚îÄ configuration.md
‚îÇ   ‚îú‚îÄ‚îÄ docker.md
‚îÇ   ‚îú‚îÄ‚îÄ manifests.md
‚îÇ   ‚îî‚îÄ‚îÄ summary.md
‚îú‚îÄ‚îÄ eslint.config.mjs
‚îú‚îÄ‚îÄ infrastructure
‚îÇ   ‚îú‚îÄ‚îÄ helm
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Chart.yaml
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ values.yaml
‚îÇ   ‚îî‚îÄ‚îÄ manifests/
‚îÇ       ‚îú‚îÄ‚îÄ auto-scaler.yaml
‚îÇ       ‚îú‚îÄ‚îÄ kyverno.yaml
‚îÇ       ‚îú‚îÄ‚îÄ network-policy.yaml
‚îÇ       ‚îî‚îÄ‚îÄ vault.yaml
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app.controller.ts
‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ app.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ main.ts
‚îÇ   ‚îî‚îÄ‚îÄ redis/
‚îÇ       ‚îú‚îÄ‚îÄ redis.service.ts
‚îÇ       ‚îî‚îÄ‚îÄ redis.service.spec.ts
‚îú‚îÄ‚îÄ test/
‚îÇ   ‚îú‚îÄ‚îÄ app.e2e-spec.ts
‚îÇ   ‚îî‚îÄ‚îÄ jest-e2e.json
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ nest-cli.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îî‚îÄ‚îÄ README.md
```

## üì¶ –û—Å–Ω–æ–≤–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
### üß† src/
–¢—É—Ç —Ä–æ–∑–º—ñ—â–µ–Ω–∏–π NestJS –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î –æ—Å–Ω–æ–≤–Ω—É –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫—É.
–í–∫–ª—é—á–∞—î –±–∞–∑–æ–≤—É —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ Redis —Ç–∞ —Ç–µ—Å—Ç–æ–≤–∏–π endpoint /redis –¥–ª—è health-check.


### üõ† infrastructure/helm/

Helm Chart –¥–ª—è –¥–µ–ø–ª–æ—é –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –≤ Kubernetes.
–ú—ñ—Å—Ç–∏—Ç—å:
- Deployment, Service, Ingress –¥–ª—è NestJS
- Init –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —è–∫–∏–π –æ—á—ñ–∫—É—î –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å Redis
- Secrets
- Resource limits/requests
- SecurityContext (runAsNonRoot, drop capabilities)
- HPA, ServiceMonitor, PodDisruptionBudget
- TLS —á–µ—Ä–µ–∑ cert-manager

–¶–µ–π —á–∞—Ä—Ç –¥–æ–∑–≤–æ–ª—è—î —à–≤–∏–¥–∫–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫ —É –±—É–¥—å-—è–∫–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é helm upgrade -i.

### üßæ infrastructure/manifests/

–î–æ–¥–∞—Ç–∫–æ–≤—ñ Kubernetes –º–∞–Ω—ñ—Ñ–µ—Å—Ç–∏:
- auto-scaler.yaml ‚Äì Horizontal Pod Autoscaler
- network-policy.yaml ‚Äì –æ–±–º–µ–∂—É—î —Ç—Ä–∞—Ñ—ñ–∫, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –¥–æ—Å—Ç—É–ø –ª–∏—à–µ –º—ñ–∂ –∞–ø–∫–æ—é —Ç–∞ Redis
- kyverno.yaml ‚Äì –ø–æ–ª—ñ—Ç–∏–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥–ø–∏—Å–∞–Ω–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Cosign
- vault.yaml ‚Äì —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ HashiCorp Vault (Vault Secrets Operator, policy, auth, secrets)


### üìö docs/

–¢—É—Ç –∑—ñ–±—Ä–∞–Ω–∞ –≤—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø–æ –ø—Ä–æ—î–∫—Ç—É:
- ci-cd.md ‚Äì GitHub Actions
- configuration.md ‚Äì —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –ø–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω—é –≤—Å—ñ—î—ó –∞–ø–∫–∏
- docker.md ‚Äì –æ–ø–∏—Å –ø–æ–±—É–¥–æ–≤–∏ —ñ–º–µ–¥–∂—É —á–µ—Ä–µ–∑ Buildah
- manifests.md ‚Äì –æ–ø–∏—Å —É—Å—ñ—Ö –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤
- summary.md ‚Äì –∑–∞–≥–∞–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞, —Å—Ç–µ–∫, –≤–∏–±—ñ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π

## üöÄ –û—Å–Ω–æ–≤–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                   | –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ                                                  | –ü—Ä–∏—á–∏–Ω–∞                                                                |
| --------------------------- | ------------------------------------------------------------ | ---------------------------------------------------------------------- |
| **Container Builder**       | **Buildah**                                                  | –ë–µ–∑ root –¥–æ—Å—Ç—É–ø—É, –∫–µ—à—É–≤–∞–Ω–Ω—è —à–∞—Ä—ñ–≤, —à–≤–∏–¥—à–µ –∑–∞ Docker, –∑—Ä—É—á–Ω–∏–π –¥–ª—è CI/CD |
| **Security Policy Engine**  | **Kyverno**                                                  | –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫ –±–µ–∑–ø–µ–∫–∏, –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—ñ–¥–ø–∏—Å—ñ–≤ —ñ–º–µ–¥–∂—ñ–≤   |
| **Image Signing**           | **Cosign**                                                   | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ —Ç–∞ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤                         |
| **Secret Management**       | **HashiCorp Vault + Vault Secrets Operator**                 | –ë–µ–∑–ø–µ—á–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç–∞–º–∏ —á–µ—Ä–µ–∑ Kubernetes —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é              |
| **Redis**                   | **Redis Cluster**                                            | –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ –∫–µ—à —ñ –º–µ—Ö–∞–Ω—ñ–∑–º —Ç–∏–º—á–∞—Å–æ–≤–æ–≥–æ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö        |
| **Ingress Controller**      | **NGINX Ingress + cert-manager**                             | TLS —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ Let's Encrypt, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è HTTP/S                    |
| **Monitoring**              | **Victoria Metrics Stack, Grafana, Falco, Kyverno Exporter** | –ë–µ–∑–ø–µ–∫–∞, –ª–æ–≥—É–≤–∞–Ω–Ω—è, –∞–ª–µ—Ä—Ç–∏, –º–µ—Ç—Ä–∏–∫–∏                                    |
| **Scaling**                 | **HPA (Horizontal Pod Autoscaler)**                          | –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—É                                      |
| **Network Security**        | **NetworkPolicy**                                            | –û–±–º–µ–∂–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –º—ñ–∂ –ø–æ–¥–∞–º–∏                                           |
| **Image Registry Security** | **Cosign Key Validation (Kyverno Policy)**                   | –ó–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤                                       |
| **Vault Policy**            | **Fine-grained RBAC**                                        | –î–æ—Å—Ç—É–ø –ª–∏—à–µ –¥–æ –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö —Å–µ–∫—Ä–µ—Ç—ñ–≤ —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É namespace              |
| **Build pipeline**          | **GitHub Actions + Helm Deploy**                             | –ü–æ–≤–Ω—ñ—Å—Ç—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏–π –¥–µ–ø–ª–æ–π —É –∫–ª–∞—Å—Ç–µ—Ä                              |


## üß© –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

![architecture](./docs/test-devops.jpg)